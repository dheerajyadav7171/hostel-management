<!DOCTYPE html>
<html lang="en">
<head th:replace="dashboard/layouts/header :: header">
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<div class="row">
    <div class="col-lg-3" th:switch="${user.role}">
        <a th:case="student" th:href="@{/complaints/add}" class="btn btn-primary btn-sm mb-3"> Lodge Complaint</a>
    </div>
</div>

<div th:switch="${user.role}">
    <span th:case="admin">
        <form th:action="@{/complaints}" method="get">
            <label for="txtsearch"></label><input id="txtsearch" type="text" name="keyword">
            <button type="submit"> Search</button>
        </form>
    </span>
</div>


<table class="table table-striped table-bordered">
    <thead class="table-dark">
    <tr th:switch="${user.role}">
        <span th:case="admin">
            <th> Roll Number</th>
            <th> Hostel Name</th>
            <th>Session Name</th>
            <th> Complaint Description</th>
            <th> Complaint Time</th>
            <th> Status</th>
            <th> Action</th>
        </span>
        <span th:case="student">
            <th> Complaint Description</th>
            <th> Complaint Time</th>
            <th> Status</th>
        </span>
    </tr>
    </thead>
    <tbody>
    <tr th:each="complaint,iter: ${complaints}" th:switch="${user.role}">
        <span th:case="student">
            <td th:text="${complaint.description}"></td>
            <td th:text="${complaint.timestamp}"></td>
            <td th:text="${complaint.status}"></td>
        </span>
        <span th:case="admin">
            <td th:text="${complaint.rollNo}"></td>
            <td th:text="${hostelNames[__${iter.index}__]}"></td>
            <td th:text="${sessionNames[__${iter.index}__]}"></td>
            <td th:text="${complaint.description}"></td>
            <td th:text="${complaint.timestamp}"></td>
            <td th:text="${complaint.status}"></td>
            <td>
                <form th:action="@{/updateStatus}" method="post">
                    <input type="hidden" th:name="complaintID" th:value="${complaint.complaintId}"/>
                    <button type="submit" th:if="${complaint.status == 'Pending'}">Mark Complete</button>
                </form>
            </td>
        </span>

    </tr>
    </tbody>

</table>

</body>
</html>